MSU Analyzer
============

A simple Windows Update packages management tool to isolate newer updates.

Updates for Windows Vista and newer OS come packaged in MSU or CAB files, which can be downloaded once and stored offline to update different PC many times: but they tend to waste space in the long period, since it is difficult to see which packages supersede others.

These two Python 2.7 scripts (thoroughly based on SQL capabilities provided by SQLite 3 builtin engine) help the user to list the packages he has to save, and those he can safely delete.

SetupPackagesAnalyzer.py scans one or more directory trees containing Windows MSU or CAB updates, analyzes each and emits a .log file with 3 sections ([Saved], [Proposed] and [Purged], where the latter contains the deletable files) storing the results in a database for future use.

When given a .log file generated by the other script, PackagesCopyHelper.py moves the packages in 2 directories, "saved" and "purged".

Theory
======
The task is done observing that each update CAB (eventually, the main one stored inside the MSU) contains many x86_*.manifest files (and, in a 64-bit OS, even amd64_ or wow64_), one for each updated component.
They are mere XML documents where a tag <assemblyIdentity> and its properties "name", "version" and "processorArchitecture" can be compared to see if the update hits the same component.
When "name" and "processorArchitecture" are equal, we select the more recent "version"; if version is the same too, we choose the package with the more recent manifest, or, finally, the more recent package date.
If a package does not contain manifests, it is treated as special and equally preserved.

Prerequisites
=============
- Python 2.7 (look at https://www.python.org/ ).
- 7-Zip (look at http://www.7-zip.org/ ) to extract from MSU and CAB files.
